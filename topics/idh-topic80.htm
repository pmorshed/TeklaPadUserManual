<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!-- saved from url=(0025)http://www.helpsmith.com/ -->
<head>
<title>C# basics</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1256" />
<meta name="generator" content="HelpSmith 6.4 (Build 17.127)" />
<style type="text/css" media="screen">
html {
  height: 100%;
}
body {
  background-color: #f0f3f7;
  margin: 12px 0 12px 0;
}
</style>
<link type="text/css" href="../css/topics/style.css" rel="stylesheet" />
<script type="text/javascript" src="../js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="../js/settings.js?dea2e7bf"></script>
<script type="text/javascript" src="../js/core.js?e3fa3091"></script>
<script type="text/javascript" src="../js/topic.js?e3fa3091"></script>
<script type="text/javascript">
	var topicContext = 80;
</script>
</head>
<body>
<div align="center">
  <table class="tbl0">
    <tr class="row0">
      <td class="cell0">
        <p>&nbsp;</p>
      </td>
      <td class="cell1">
        <div align="center">
          <table class="tbl1">
            <tr class="row0">
              <td class="cell0">
                <p>&nbsp;</p>
              </td>
              <td class="cell1">
                <div align="center">
                  <table class="tbl0">
                    <tr class="row0">
                      <td class="cell1">
                        <p class="ps0"><span class="ts0">Navigation: </span><a href="idh-topic20.htm" class="hs0">Tab1: Tekla Database</a><span class="ts0">&nbsp;&gt; </span></p>
                        <p class="ps1"><span class="ts1">C# basics</span></p>
                      </td>
                      <td class="cell2">
                        <p class="ps2"><a href="idh-topic40.htm" title="User Interface" class="hs0">Previous</a><span class="ts0">&nbsp;</span><a href="idh-topic50.htm" title="Samples" class="hs0">Next</a></p>
                      </td>
                    </tr>
                  </table>
                </div>
              </td>
              <td class="cell0">
                <p>&nbsp;</p>
              </td>
            </tr>
            <tr class="row0">
              <td class="cell0">
                <p>&nbsp;</p>
              </td>
              <td class="cell2">
                <p class="ps3"><span class="ts2">&nbsp;</span></p>
                <div align="center">
                  <table class="tbl5">
                    <tr class="row0">
                      <td class="cell0" rowspan="2">
                        <p class="ps8"><img width="65" height="62" border="0" src="images/cs.png" /></p>
                      </td>
                      <td class="cell1" rowspan="2">
                        <p class="ps9"><span class="ts21">&nbsp;C# Basics</span></p>
                      </td>
                    </tr>
                  </table>
                </div>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <div align="center">
                  <table class="tbl2">
                    <tr class="row0">
                      <td class="cell22">
                        <p><span class="ts12">This chapter is for those who are not so much familiar with C# but wants to use it for interacting with Tekla Structures. So in this section we'll focus on query area and discuss about some primary aspects of C# language and LINQ syntax</span></p>
                      </td>
                      <td class="cell23">
                        <p><img width="316" height="370" border="0" src="images/cssyntaxarea.png" /></p>
                      </td>
                    </tr>
                  </table>
                </div>
                <div>
                  <div class="hline0"></div>
                </div>
                <p><span class="ts22">In this Chapter:</span></p>
                <p><span class="ts38">- </span><a href="idh-topic80.htm#TB1_CSSyntax" class="hs3">About C# syntax</a><span class="ts9">&nbsp;</span></p>
                <p><span class="ts38">- </span><a href="idh-topic80.htm#TB1_QUERY" class="hs3">About query &amp; LINQ syntax</a></p>
                <p><span class="ts38">- </span><a href="idh-topic80.htm#TB1_QUERY_D" class="hs3">Look closer to query</a></p>
                <p><span class="ts38">- </span><a href="idh-topic80.htm#TB1_INTELLISENSE" class="hs3">About intellisense </a></p>
                <p>&nbsp;</p>
                <div>
                  <div class="hline0"></div>
                </div>
                <p><span class="ts39">&nbsp;</span></p>
                <p><a name="TB1_CSSyntax"></a><span class="ts22">&gt;About C# syntax</span></p>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <div align="center">
                  <table class="tbl4">
                    <tr class="row0">
                      <td class="cell1" colspan="2">
                        <p class="ps4"><span class="ts17">Comment lines:</span></p>
                        <p class="ps4"><span class="ts6">Every line that starts with &quot;//&quot; is a comment line. Comments can be used to document what the program (query) does. It makes your query more readable. Since the C# compiler ignores comments, you can include them anywhere in a program without affecting your code.</span></p>
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="466" height="296" border="0" src="images/comments.png" /></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell1">
                        <p><img width="232" height="222" border="0" src="images/commentpic.png" /></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell1" colspan="2">
                        <p class="ps4"><span class="ts17">Statement terminators:</span></p>
                        <p class="ps4"><span class="ts6">Every C# statement, not every line, ends with semicolon (&quot;;&quot;).</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="473" height="299" border="0" src="images/semicolons.png" /></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell1">
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                  </table>
                </div>
                <p>&nbsp;</p>
                <div>
                  <div class="hline0"></div>
                </div>
                <p>&nbsp;</p>
                <p><a name="TB1_QUERY"></a><span class="ts11">&gt;</span><span class="ts22">About query &amp; LINQ syntax</span></p>
                <p><span class="ts40">&nbsp;</span></p>
                <div align="center">
                  <table class="tbl2">
                    <tr class="row0">
                      <td class="cell24" colspan="2">
                        <p class="ps4"><span class="ts41">var</span><span class="ts17">&nbsp;keyword:</span></p>
                        <p class="ps4"><span class="ts6">var (means &quot;variable&quot;) is used to define query (or any variable) with an arbitrary name (for example: </span><span class="ts32">SampleQuery</span><span class="ts6">).</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts17">Database:</span></p>
                        <p class="ps4"><span class="ts6">Database is a </span><span class="ts32">predefined </span><span class="ts6">variable which is responsible for storing the current user selection. After selecting of any area in model, the related data will be stored in this variable automatically and can be used in your query body.</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts41">return </span><span class="ts17">keyword:</span></p>
                        <p class="ps4"><span class="ts6">Returns the result to the data table. </span></p>
                        <p class="ps4"><span class="ts33">Note:</span><span class="ts6">&nbsp;This statement is not arbitrary. You </span><span class="ts17">must </span><span class="ts6">declare the final result for passing to data table. </span></p>
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell24">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="567" height="234" border="0" src="images/methodbody.png" /></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell25">
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell24" colspan="2">
                        <p>&nbsp;</p>
                        <p class="ps4"><span class="ts17">Query body: </span></p>
                        <p class="ps4"><span class="ts6">C# query syntax (LINQ) is very similar to SQL (Structured Query Language) in database. The LINQ (Language Integrated Query) syntax starts with </span><span class="ts41">from</span><span class="ts42">&nbsp;</span><span class="ts6">keyword and ends with </span><span class="ts41">select</span><span class="ts6">&nbsp;keyword, and the conditions are defined by </span><span class="ts43">where </span><span class="ts6">keyword. </span></p>
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell24">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="569" height="235" border="0" src="images/query.png" /></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell25">
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell26" colspan="2">
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><a name="TB1_GTR"></a><img width="25" height="25" border="0" src="images/exclusive.png" /><span class="ts17">&quot;GetTeklaReport&quot; function</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaReport is not a part of standard Tekla API. It is an exclusive function which is only accessible while using the first tab of TeklaPad. Utilizing this function makes extracting data more efficient. </span></p>
                        <p class="ps4"><span class="ts33">Note1:</span><span class="ts6">&nbsp;This function accepts template attributes. Some attributes can be found on &quot;view filter&quot;&nbsp;dialog box and complete list can be found on &quot;Template Attribute Reference Guide&quot;.</span></p>
                        <p class="ps4"><span class="ts33">Note2:</span><span class="ts6">&nbsp;GetTeklaReport function's input is flexible and is not case sensitive. For example, &quot;LENGTH_NET&quot; and &quot;length_net&quot; and &quot;length net&quot; (or &quot;length&nbsp;&nbsp;&nbsp;&nbsp; net&quot; or &quot;LenGth NET&quot;) give same results. </span></p>
                        <p class="ps4"><span class="ts33">Note3:</span><span class="ts6">&nbsp;You can also define precision (between 0 and 9) for numeric values. default value is 2. It is optional and also has no effect on non-numeric values.</span></p>
                        <p class="ps4"><span class="ts44">&nbsp;</span></p>
                        <p class="ps4"><span class="ts17">Usage samples:</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaReport(&quot;length net&quot;) ------&gt; </span><span class="ts34">Returns net length of object (it returns &quot;-&quot; if failed to calculate that attribute) with default precision (2 digits).</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaReport(&quot;volume&quot;, 8) ------&gt; </span><span class="ts34">Returns volume of object with 6 digits of precision.</span></p>
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell27">
                        <p class="ps6"><img width="472" height="87" border="0" src="images/gtr1.png" /></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="487" height="377" border="0" src="images/templateattributes1.png" /></p>
                        <p class="ps5"><span class="ts6">[View filter dialog box]</span></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="362" height="294" border="0" src="images/image(8).png" /></p>
                        <p class="ps5"><span class="ts6">[Template Attribute Reference Guide]</span></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell28">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell29" colspan="2">
                        <p>&nbsp;</p>
                        <p class="ps4"><a name="TB1_POUT"></a><img width="25" height="25" border="0" src="images/exclusive.png" /><span class="ts17">&quot;GetTeklaPullOut&quot; function</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaPullOut is not a part of standard Tekla API. It is an exclusive function which is only accessible while using the first tab of TeklaPad. This function returns pull-out picture for numbered reinforcements.</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts33">Note1:</span><span class="ts6">&nbsp;This function accepts 5 named parameters:</span></p>
                        <p><img width="881" height="92" border="0" src="images/npoutdef.png" /></p>
                        <p class="ps4"><span class="ts17">1) ImageWidth:</span><span class="ts6">&nbsp;indicates approximate width of image in pixel </span><span class="ts17">(Min:60, Default:150)</span></p>
                        <p class="ps4"><span class="ts17">2) Image Height:</span><span class="ts6">&nbsp;indicates approximate height of image in pixel </span><span class="ts17">(Min:60, Default:100)</span></p>
                        <p class="ps4"><span class="ts17">3) FontSize:</span><span class="ts6">&nbsp;Indicate font size on pull-out picture </span><span class="ts17">(Default:3 Max:6)</span></p>
                        <p class="ps4"><span class="ts17">4) FontColor: </span><span class="ts6">Indicates font color </span><span class="ts17">(1~13 Default:1)</span></p>
                        <p class="ps4"><span class="ts17">5) ScaleType:</span><span class="ts6">&nbsp;If you set this attribute to &quot;true&quot;, the pull-out pictures will be scaled to fit the available space in both X and Y dimensions. As a result, the shape becomes out of proportion, but small segments can be seen more easily </span><span class="ts17">(Default: false) </span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts33">Note2:</span><span class="ts6">&nbsp;Make sure that rebar/cast unit/part numbers are up to date while using this method (unless the result will be </span><span class="ts17">null</span><span class="ts6">):</span></p>
                        <p class="ps4"><img width="334" height="184" border="0" src="images/numbering.png" /><span class="ts6">&nbsp;</span><span class="ts17">or </span><img width="270" height="171" border="0" src="images/nui1.png" /><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts33">Note3:</span><span class="ts6">&nbsp;It's recommended to remove duplicate rows before</span><span class="ts17">&nbsp;</span><span class="ts6">using this method to increasing the performance. (Discussed more </span><a href="idh-topic50.htm#FirstSamRebar" class="hs1">here</a><span class="ts6">). </span></p>
                        <p>&nbsp;</p>
                        <p class="ps4"><span class="ts17">Usage samples:</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaPullOut() ====================&gt; </span><span class="ts34">Using default values for all parameters.</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaPullOut(110, 110) ===============&gt; </span><span class="ts34">Using given values for first and second parameters and using default values for other parameters.</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaPullOut(110, 90, 2, 2, false) =========&gt; </span><span class="ts34">Using given values for each parameter.</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaPullOut(FontColor:2) ==============&gt; </span><span class="ts34">Overriding the default value for &quot;font color&quot; and using default values for other parameters.</span></p>
                        <p class="ps4"><span class="ts6">GetTeklaPullOut(FontSize:2, ImageHeight:110) ===&gt; </span><span class="ts34">Overriding the default values for &quot;font size&quot; and &quot;image height&quot; and using default values for other parameters.</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell29">
                        <p>&nbsp;</p>
                      </td>
                      <td class="cell30">
                        <p>&nbsp;</p>
                      </td>
                    </tr>
                  </table>
                </div>
                <div>
                  <div class="hline0"></div>
                </div>
                <p><span class="ts40">&nbsp;</span></p>
                <p><a name="TB1_QUERY_D"></a><span class="ts22">&gt;Look closer to query</span></p>
                <p><span class="ts40">&nbsp;</span></p>
                <p class="ps4"><span class="ts6">In general, creating a query contains three steps:</span></p>
                <div align="center">
                  <table class="tbl2">
                    <tr class="row0">
                      <td class="cell31">
                        <p class="ps4"><span class="ts6">1- Defining the original data source (</span><span class="ts17">Database</span><span class="ts6">).</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts33">Note:</span><span class="ts6">&nbsp;Defining the original database is done by using </span><span class="ts43">&quot;from&quot; </span><span class="ts6">keyword in LINQ syntax.</span></p>
                      </td>
                      <td class="cell32">
                        <p class="ps4"><span class="ts6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><img width="108" height="96" border="0" src="images/table.png" /></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell31">
                        <p class="ps4"><span class="ts6">2- Filtering on rows (only choose some rows by putting some conditions). </span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts33">Note:</span><span class="ts6">&nbsp;In LINQ syntax this step is typically done by using </span><span class="ts43">&quot;where&quot;</span><span class="ts6">&nbsp;keyword.</span></p>
                      </td>
                      <td class="cell32">
                        <p><img width="146" height="94" border="0" src="images/qs2n.png" /></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell31">
                        <p class="ps4"><span class="ts6">3- Filtering on columns (choose only some defined columns) and selecting (construct) the </span><span class="ts43">new</span><span class="ts17">&nbsp;</span><span class="ts6">table from original table.</span></p>
                        <p class="ps4"><span class="ts6">&nbsp;</span></p>
                        <p class="ps4"><span class="ts33">Note:</span><span class="ts6">&nbsp;In LINQ syntax this step is typically done by using </span><span class="ts43">&quot;select&quot; </span><span class="ts6">keyword.</span></p>
                      </td>
                      <td class="cell32">
                        <p><img width="276" height="129" border="0" src="images/qs5n.png" /></p>
                      </td>
                    </tr>
                  </table>
                </div>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <p class="ps4"><span class="ts6">Now let's see these 3-steps in a practical example:</span></p>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <p><img width="628" height="447" border="0" src="images/linqpractice.png" /></p>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <p class="ps4"><img width="20" height="20" border="0" src="images/info.png" /><span class="ts6">You can find more important techniques about queries in </span><a href="idh-topic100.htm" class="hs1">Tips</a><span class="ts6">&nbsp;page.</span></p>
                <div>
                  <div class="hline0"></div>
                </div>
                <p><span class="ts40">&nbsp;</span></p>
                <p><a name="TB1_INTELLISENSE"></a><span class="ts22">&gt;About </span><span class="ts11">intellisense </span></p>
                <p>&nbsp;</p>
                <div align="center">
                  <table class="tbl4">
                    <tr class="row0">
                      <td class="cell2" colspan="2">
                        <p class="ps4"><span class="ts6">C# language has its own syntax and also is case sensitive. An intellisense window is a smart code completion feature which makes writing code faster and less error-prone. It is an assistant window that appears automatically after '</span><span class="ts17">.</span><span class="ts6">' and '</span><span class="ts17">(</span><span class="ts6">' to show hint or possible options. It is also possible to call it manually by pressing &quot;</span><span class="ts17">Ctrl+space</span><span class="ts6">&quot;, and other good news is that the code snippet feature is also available.</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="505" height="158" border="0" src="images/image(3).png" /></p>
                        <p class="ps5"><span class="ts6">[Shows the correct name by pressing </span><span class="ts17">Ctrl+space</span><span class="ts6">]</span></p>
                      </td>
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="400" height="146" border="0" src="images/image(5).png" /></p>
                        <p class="ps5"><span class="ts6">[Shows the options after '</span><span class="ts17">.</span><span class="ts6">' ]</span></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                    <tr class="row0">
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                        <p class="ps6"><img width="505" height="94" border="0" src="images/gtr1.png" /></p>
                        <p class="ps5"><span class="ts6">[Shows the correct format after '</span><span class="ts17">(</span><span class="ts6">' ]</span></p>
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                      <td class="cell1">
                        <p class="ps5"><span class="ts6">&nbsp;</span></p>
                      </td>
                    </tr>
                  </table>
                </div>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <p class="ps4"><span class="ts6">&nbsp;</span></p>
                <p class="ps3"><span class="ts2">&nbsp;</span></p>
              </td>
              <td class="cell0">
                <p>&nbsp;</p>
              </td>
            </tr>
            <tr class="row0">
              <td class="cell3">
                <p>&nbsp;</p>
              </td>
              <td class="cell4">
                <p>&nbsp;</p>
              </td>
              <td class="cell5">
                <p>&nbsp;</p>
              </td>
            </tr>
          </table>
        </div>
      </td>
      <td class="cell0">
        <p>&nbsp;</p>
      </td>
    </tr>
  </table>
</div>
</body>
</html>